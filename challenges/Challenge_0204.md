# Challenge 0204 23/10/2025

## Pitch de l‚Äôexercice üßë‚Äçüè´

‚å®Ô∏è Atelier Mme Michu

Hello üëã

Aujourd‚Äôhui, tu vas devoir **diagnostiquer et r√©soudre plusieurs pannes** sur l‚Äôordinateur de *Madame Michu*, une utilisatrice √¢g√©e sympathique qui adore les Yorkshires.

Voici le message qu‚Äôelle t‚Äôas envoy√© :

> Bonjour,
> Mon ordinateur ne veut plus d√©marrer correctement, et quand j‚Äôarrive enfin sur le Bureau, mon processeur et ma RAM sont utilis√©s √† 100% (elle est balaise, Mme Michu, pour le pr√©-diagnostic). En plus, j‚Äôai remarqu√© que des fichiers dans mon dossier ¬´ Images ¬ª ont disparu ! Je suis inqui√®te pour l‚Äô√©tat de mes disques durs aussi, il parait qu‚Äôils sont d√©fectueux, pourrais-tu les v√©rifier aussi ?
> Merci beaucoup de ton aide !

Ta mission est de diagnostiquer et corriger les diff√©rentes pannes pr√©sentes sur la machine de Madame Michu en suivant ces quatre √©tapes :

1. R√©parer le d√©marrage de Windows,
2. Restaurer les performances normales de la machine,
3. V√©rifier l‚Äô√©tat des disques durs,
4. Retrouver les fichiers disparus dans le dossier ¬´ Images ¬ª.

Vu que ce serait contraignant de vous envoyer le PC de Mme Michu par la poste, on va travailler sur une machine virtuelle VirtualBox. T√©l√©charge-la [ici](https://drive.google.com/drive/u/0/folders/1gFLf4c9vBFUtFSUy1Q04AFhvRddjFzzH) au format OVA et commence ta mission üí™

Tu n‚Äôauras pas besoin de mot de passe que ce soit pour lancer le fichier OVA ou pour la session de Madame Michu.

Prends ton temps et suis les √©tapes dans l‚Äôordre !

## Documentation

N‚Äôh√©site pas √† documenter chaque √©tape pour faire un retour d√©taill√© √† ton formateur et expliquer les actions que tu as effectu√©es.

Cela permettra aussi de bien comprendre l‚Äôorigine des pannes et de fournir √† Madame Michu un rapport complet. (PS: Pas indispensable pour l‚Äôatelier, mais √ßa peut √™tre un bon entrainement !)

Bon courage et bonne r√©solution de pannes üí™

## √âtape 1 : R√©parer le d√©marrage de Windows

Probl√®me rencontr√© : L‚Äôordinateur de Madame Michu refuse de d√©marrer correctement, avec des messages tels que ¬´ BootMGR est manquant ¬ª ET ¬´ Winload.exe introuvable ¬ª, son petit-fils a test√© des trucs, donc il n‚Äôy a plus les messages mais le probl√®me est le m√™me, donc ne t‚Äôen fais pas si tu ne vois pas les m√™mes messages !

Si je peux te donner un conseil, fais attention aux partitions et √©galement au lecteur, si tu avances dans ton diagnostic, peut-√™tre que tu vas t‚Äôemm√™ler les pinceaux avec le C: D: E: F: G: etc‚Ä¶ donc prends le temps de bien rep√©rer ton lecteur !

R√©sous ce probl√®me pour permettre √† Windows de d√©marrer normalement.

## √âtape 2 : Restaurer les performances normales de la machine

Probl√®me rencontr√© : Une fois sur le Bureau, Madame Michu constate que son processeur et sa RAM sont utilis√©s √† 100 %, rendant l‚Äôordinateur tr√®s lent.

Diagnostique et r√©sous ce probl√®me pour restaurer les performances optimales.

Il y a plusieurs solutions je pense, mais si tu arrives √† restaurer les performances de son PC, l‚Äô√©tape est r√©ussie !

## √âtape 3 : V√©rifier l‚Äô√©tat des disques durs

Probl√®me rencontr√© : Madame Michu s‚Äôinqui√®te de l‚Äô√©tat de ses disques durs. Oui, elle a 2 disques d‚Äôapr√®s ce qu‚Äôelle m‚Äôa dit, √† v√©rifier donc si tout va bien de ce c√¥t√©-l√†.

V√©rifie les disques pour d√©tecter d‚Äô√©ventuels probl√®mes et corrige-les si n√©cessaire.

## √âtape 4 : Retrouver les fichiers disparus dans le dossier ¬´ Images ¬ª

Probl√®me rencontr√© : Des fichiers ont myst√©rieusement disparu dans le dossier ¬´ Images ¬ª de Madame Michu.

Retrouve et restaure ces fichiers pour elle.

---

## R√©solution üìû

Ayant r√©cup√©r√© le PC de Mme Michu je vais pouvoir commencer √† diagnostiquer les probl√®mes.

### √âtape 1 : R√©parer le d√©marrage de Windows üõ†Ô∏è

Au lancement, voici l'√©cran qui s'affiche :

![D√©marrage](../images/TPmichu1.png)

On m'a pr√©cis√© que ¬´ BootMGR est manquant ¬ª et ¬´ Winload.exe introuvable ¬ª, c'est donc que le BootManager qui lance le Winloaderr est introuvable (probl√®me 1) et le Winload pour lancer Windows correctement l'est aussi (probl√®me 2).

Je vais donc ins√©rer un disque Windows pour boot dessus et fixer le probl√®me de BootMGR en premier.

![Winsows](../images/TPmichu2.png)

Je lance l'utilitaire de r√©paration.

![Repair](../images/TPmichu3.png)

J'ai lanc√© l'Outil de red√©marrage pour r√©parer automatiquement mais sans succ√®s.

![Fail](../images/TPmichu4.png)

J'entre dans le terminal pour afficher la liste de mes disques avec le ``Diskpart`` et ``list disk`` puis ``list vol`` et d√©terminer lequel est le disque Windows, c'est le disque ``C:`` qui est actuellement assign√© √† Windows ``"R√©serv√© au syst√®me"``, je vois un disque ``D: Data``, je sais que je devrais faire attention √† ne surtout pas l'effacer!

![Disklist](../images/TPmichu5.png)

Je vais tenter la m√©thode du Fix Master Boot Record avec les commandes ``bootrec /FixMbr``, ``bootrec /FixBoot``, ``bootrec /RebuildBcd``.

![fixboot](../images/TPmichu6.png)

L'acc√®s est refus√©, cel√† vient √† priori du type de partitionnement, la commande /fixboot est con√ßue pour l'ancien syst√®me MBR/BIOS et non EFI moderne.

Je vais √† nouveau v√©rifier mes disques et leurs partition avec ``list partition``, chercher la/les partitions EFI sur mes disques.

![ListPart](../images/TPmichu7.png)

Je vois que 2 d√©tails m'ont √©chapp√©, le format et la taille des partitions, en effet la partition EFI du BootMNG doit √™tre en fat32 pour pouvoir √™tre lu universellement par le BIOS/UEFI, il faut donc la reformater. Les fichiers Windows sont quand √† eux dans la partition 2 (E:) et c'est eux qu'on va copier avec bcdboot vers la partition C:

*The command ``bcdboot C:\Windows /s E:`` copies essential boot files from the Windows directory (E:\Windows) to the system partition (C:) and recreates the Boot Configuration Data (BCD) store, which is required for the system to start.*

![bcdboot](../images/TPmichu8.png)

Une fois ces op√©rations effectu√©es, je reboot la machine, et j'arrive sur cet √©cran bleu. C'est d√©j√† une progression, on sait que le BootMNG est r√©par√©, c'est maintenant l'√©tape du Winload, qui lui est HS ou introuvable et ne peux donc pas charcher l'OS.

Il va donc falloir r√©parer les fichiers Windows avec le SFC (System File Checker).

![winload.exe](../images/TPmichu9.png)

Je relance la machine, je boot sur l'image Windows, j'utilise la commande ``MAF + F10`` pour aller directement √† la console et lancer un Check Disk par pr√©caution, pour s'assurer que le disque est sain avant de r√©parer Windows.

``chkdsk E: /f /r``  /f corrige les erreurs sur le disque.  /r localise les secteurs d√©fectueux et r√©cup√®re les informations lisibles.

Le checkdisk est un peu long, il m'a laiss√© le temps de d√©jeuner ^^

![chkdsk](../images/TPmichu10.png)

Tout est OK on va pouvoir passer au SFC (System File Checker) pour analyser les fichiers et remplacer ceux qui peuvent √™tre HS comme notre *winload.exe*.

``sfc /scannow /offbootdir=E:\ /offwindir=E:\Windows``

``/scannow`` : C'est l'ordre de scanner et r√©parer.

``/offbootdir=E:\`` : Indique que le lecteur de d√©marrage (l√† o√π se trouve Windows) est E:.

``/offwindir=E:\Windows`` : Sp√©cifie le chemin exact du dossier Windows √† r√©parer.

![SFC](../images/TPmichu11.png)

SFC √† bien d√©tect√© et r√©par√© des fichiers corrompus.

![SFCOK](../images/TPmichu12.png)

Je red√©marre la machine et c'est bon, Windows est r√©par√© et load comme il se doit, on tombe sur la session de Mme Michu !

![OKMICHU](../images/TPmichu13.png)

---

### √âtape 2 : Restaurer les performances normales de la machine üïµÔ∏è

Mon premier r√©flexe est d'ouvrir le gestionnaire des taches  ``Crtl + MAJ + Echap`` pour regarder ce qui se passe en fond sur la machine : Analyser les performances et les processus.

![Gestionnaire](../images/TPmichu14.png)

Aucun programme seul n'est entrain d'utiliser le processeur √† plus de 30%.

Aucun programme seul n'est entrain de saturer la m√©moire.

Par contre je me rend compte qu'il y a une quantit√© anormale de petit processus identiques li√©s √† la Console et √† une demande de Ping, qui consomment pas grand chose individuelement mais saturent le syst√®me vu la quantit√© pr√©sente !

![Proc](../images/TPmichu15.png)

![Mem](../images/TPmichu16.png)

Je vais voir dans les D√©tails ce sont : conhost.exe qui est la Console windows, et PING.exe qui n'est pas un processus normal. je comprend donc qu'on a une commande malveillante, surement lanc√©e au d√©marrage (je me souviens avoir vu apparaitre brievement une console au d√©marrage).

![Cmd](../images/TPmichu17.png)

![Ping](../images/TPmichu18.png)

La machine √©tant vraiment satur√©e, je vais dans D√©marrage Windows, et je d√©sactive tout ce qui est inutile, et surtout la commande powershell. Je reboot.

![D√©marrage](../images/TPmichu21.png)

Je lance directement le Gestionnaire apr√®s le reboot et l√† on voit que les performances sont bien plus normales.

![GestionnnaireOK](../images/TPmichu22.png)

Je d√©cide donc d'aller voir en d√©tail dans le dossier de d√©marrage avec la commande ``shell:startup`` et je trouve bien le raccourcit PING.exe qui polluait ma machine au d√©marrage. J'imagine que c'est une commande malveillante pour lancer des Pings en boucle et saturer la machine. Je me rend compte que j'aurais peut √™tre d√ª faire √ßa directement plut√¥t que d'aller dans les param√®tres de D√©marrage Windows. Mais √ßa me laisse maintenant le temps d'analyser ce que c'est.

![Pinganalyse](../images/TPmichu23.png)

J'ai demand√© √† Gemini d'analyser cette commande

*Voici la commande que tu as trouv√©e dans le raccourci au d√©marrage : ``C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -WindowStyle Hidden -ExecutionPolicy Bypass -File "C:\Windows\Ping.ps1"``*

*D√©cortiquons-la pour comprendre sa toxicit√© :*

- *``powershell.exe`` C'est l'outil qui ex√©cute le script. PowerShell est un langage de commande tr√®s puissant, bien plus que l'ancienne invite de commandes.*

- *``-WindowStyle Hidden`` C'est la partie la plus vicieuse. Cet argument ordonne √† PowerShell de s'ex√©cuter sans aucune fen√™tre visible. Mme Michu ne voit absolument rien se passer sur son bureau, pendant que son PC est en train d'√™tre mis √† genoux en arri√®re-plan.*

- *``-ExecutionPolicy Bypass`` C'est un √©norme drapeau rouge de s√©curit√© ! Par d√©faut, Windows emp√™che l'ex√©cution de scripts non sign√©s pour prot√©ger l'utilisateur. Cet argument dit √† PowerShell : "Ignore toutes les r√®gles de s√©curit√© et ex√©cute le script quoi qu'il arrive". C'est comme forcer une porte de s√©curit√©.*

- *``-File "C:\Windows\Ping.ps1"`` C'est le c≈ìur du probl√®me. Cette partie ex√©cute un fichier nomm√© Ping.ps1. Le fait qu'il soit plac√© directement dans C:\Windows est une technique classique pour le cacher parmi les milliers de fichiers syst√®me l√©gitimes.*

*Que fait le script ``Ping.ps1`` ?
M√™me sans voir le contenu du fichier, on peut le deviner. Ce script contient tr√®s probablement une boucle infinie qui lance en continu la commande ping.exe.*

*√áa ressemble √† quelque chose comme √ßa en PowerShell :*

*``PowerShell
while ($true) {
    Start-Process ping.exe -ArgumentList "une_adresse_ip_cible"
}``*

*Cette boucle tourne sans jamais s'arr√™ter, lan√ßant des milliers de processus ping.exe jusqu'√† ce que le syst√®me n'ait plus aucune ressource (CPU, RAM) et se bloque compl√®tement.*

*C'est une forme d'attaque qu'on peut assimiler √† une **"Fork Bomb"** : un programme qui se r√©plique √† l'infini pour saturer les ressources d'un ordinateur et le faire planter. Dans ce cas, il ne se r√©plique pas lui-m√™me, mais il lance un autre programme en boucle.*

Maintenant il ne me reste plus qu'a nettoyer la machine.

- ``shell:startup`` pour ouvrir le dossier de d√©marrage et supprimer le Lien Malveillant.

- ``C:\Windows`` (le chemin √©tait dans le raccourcit) pour trouver le fichier ``Ping.ps1`` et le supprimer (je l'ai ouvert pour v√©rifier la commande).

- Relancer au D√©marrage Windows antivirus, faire les mises √† jour et lancer un scan pour v√©rifier que tout est OK.

### √âtape 3 : V√©rifier l‚Äô√©tat des disques durs üíΩ

### √âtape 4 : Retrouver les fichiers disparus dans le dossier ¬´ Images ¬ª üñºÔ∏è
